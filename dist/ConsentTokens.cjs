/**
 * Librairie du system desing des Bibliothèques de l'Université de Montréal
 * @module @bibudem/ui
 * @version 0.18.0
 * @author Christian Rémillard <christian.remillard@umontreal.ca>
 * @license ISC
 * @see https://github.com/bibudem/ui
 */
var e,t,n,s,a=e=>{throw TypeError(e)},i=(e,t,n)=>t.has(e)||a("Cannot "+n),c=(e,t,n)=>(i(e,t,"read from private field"),n?n.call(e):t.get(e)),o=(e,t,n)=>t.has(e)?a("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),r=(e,t,n)=>(i(e,t,"access private method"),n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const l=require("./constants-CK6XJvuv.cjs"),h=require("./isObject-D1wTAyjh.cjs");var E="[object Boolean]";function d(e){return!0===e||!1===e||h.isObjectLike(e)&&h.baseGetTag(e)==E}const u=Object.keys(l.DEFAULT_PREFERENCES);function T(e,{key:t,acceptNull:n=!1}={}){if(!d(e)&&!["granted","denied"].includes(e)&&!n&&null===e)throw new TypeError(`Invalid value${t?` for field \`${t}\``:""}: ${e}. Must be either boolean or one of 'granted' or 'denied'.`)}function f(e){if(!u.includes(e)){const t=`Invalid key: ${e}. Must be one of ${u.reduce(((e,t,n)=>n===u.length?`${e} or ${t}`:`${e}, ${t}`))}.`;throw new TypeError(t)}}e=new WeakMap,t=new WeakSet,n=function(t,n,s=!1){f(t),T(n,{key:t,acceptNull:s}),c(this,e)[t]=d(n)?n?"granted":"denied":n},s=function(t,n=!1){T(t,{acceptNull:n}),"string"!=typeof t&&(t=t?"granted":"denied"),Object.keys(c(this,e)).forEach((n=>c(this,e)[n]=t))};let b=class a{constructor(a){o(this,t),o(this,e,{...l.DEFAULT_PREFERENCES}),Object.defineProperties(this,{analytics_consent:{enumerable:!0,get:()=>c(this,e).analytics_consent,set:e=>r(this,t,n).call(this,"analytics_consent",e)},functionality_consent:{enumerable:!0,get:()=>c(this,e).functionality_consent,set:e=>r(this,t,n).call(this,"functionality_consent",e)},ad_consent:{enumerable:!0,get:()=>c(this,e).ad_consent,set:e=>r(this,t,n).call(this,"ad_consent",e)}}),void 0!==a&&(h.isObject(a)?Object.keys(l.DEFAULT_PREFERENCES).forEach((e=>{Reflect.has(a,e)&&r(this,t,n).call(this,e,a[e])})):r(this,t,s).call(this,a))}static from(e){var i;const c=new a;return e&&(h.isObject(e)?Object.keys(e).forEach((s=>{var a;r(a=c,t,n).call(a,s,e[s],!0)})):r(i=c,t,s).call(i,e,!0)),c}isGranted(t){return f(t),c(this,e)[t]===l.CONSENT_STATES.GRANTED}isDenied(t){return f(t),c(this,e)[t]===l.CONSENT_STATES.DENIED}state(){return Object.values(c(this,e)).every((e=>null!==e))?l.CONSENT_STATES.DETERMINATE:l.CONSENT_STATES.INDETERMINATE}setAll(e){h.isObject(e)?Object.entries(e).forEach((([e,s])=>r(this,t,n).call(this,e,s))):r(this,t,s).call(this,e)}resetConsent(){Object.keys(c(this,e)).forEach((t=>c(this,e)[t]=null))}toGTM(t=500){if(this.state()===l.CONSENT_STATES.INDETERMINATE){const t=Object.entries(c(this,e)).filter((e=>null===e[1]));throw new Error(`All tokens must have an explicit value. Undefined token${t.length>1?"s":""}: ${t.map((e=>e[0])).join(", ")}`)}const{analytics_consent:n,ad_consent:s}=c(this,e);return{ad_user_data:s,ad_personalization:s,ad_consent:s,analytics_consent:n,wait_for_update:t}}};exports.ConsentTokens=b;
//# sourceMappingURL=ConsentTokens.cjs.map
