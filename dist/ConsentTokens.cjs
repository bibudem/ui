/**
 * Librairie du system desing des Bibliothèques de l'Université de Montréal
 * @module @bibudem/ui
 * @version 0.15.0
 * @author Christian Rémillard <christian.remillard@umontreal.ca>
 * @license ISC
 * @see https://github.com/bibudem/ui
 */
var e,t,n,s,a,i=e=>{throw TypeError(e)},c=(e,t,n)=>t.has(e)||i("Cannot "+n),o=(e,t,n)=>(c(e,t,"read from private field"),n?n.call(e):t.get(e)),r=(e,t,n)=>t.has(e)?i("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),l=(e,t,n)=>(c(e,t,"access private method"),n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("./constants-CGwPlHYw.cjs"),E=require("./isObject-D1wTAyjh.cjs");var d="[object Boolean]";function u(e){return!0===e||!1===e||E.isObjectLike(e)&&E.baseGetTag(e)==d}const f=Object.keys(h.DEFAULT_PREFERENCES);function T(e,{key:t,acceptNull:n=!1}={}){if(!u(e)&&!["granted","denied"].includes(e)&&!n&&null===e)throw new TypeError(`Invalid value${t?` for field \`${t}\``:""}: ${e}. Must be either boolean or one of 'granted' or 'denied'.`)}function b(e){if(!f.includes(e)){const t=`Invalid key: ${e}. Must be one of ${f.reduce(((e,t,n)=>n===f.length?`${e} or ${t}`:`${e}, ${t}`))}.`;throw new TypeError(t)}}e=new WeakMap,t=new WeakSet,n=function(t,n,s=!1){b(t),T(n,{key:t,acceptNull:s}),o(this,e)[t]=u(n)?n?"granted":"denied":n},s=function(t,n=!1){T(t,{acceptNull:n}),"string"!=typeof t&&(t=t?"granted":"denied"),Object.keys(o(this,e)).forEach((n=>o(this,e)[n]=t))},a=new WeakMap;let _=class i{constructor(i){r(this,t),r(this,e,{...h.DEFAULT_PREFERENCES}),r(this,a);const d=new Error;var u,f,T,b;u=this,f=a,T=d.stack.split("\n").map((e=>e.trim())),c(u,f,"write to private field"),b?b.call(u,T):f.set(u,T),Object.defineProperties(this,{analytics_consent:{enumerable:!0,get:()=>o(this,e).analytics_consent,set:e=>l(this,t,n).call(this,"analytics_consent",e)},functionality_consent:{enumerable:!0,get:()=>o(this,e).functionality_consent,set:e=>l(this,t,n).call(this,"functionality_consent",e)},ad_consent:{enumerable:!0,get:()=>o(this,e).ad_consent,set:e=>l(this,t,n).call(this,"ad_consent",e)}}),void 0!==i&&(E.isObject(i)?Object.keys(h.DEFAULT_PREFERENCES).forEach((e=>{Reflect.has(i,e)&&l(this,t,n).call(this,e,i[e])})):l(this,t,s).call(this,i))}static from(e){var a;const c=new i;return e&&(E.isObject(e)?Object.keys(e).forEach((s=>{var a;l(a=c,t,n).call(a,s,e[s],!0)})):l(a=c,t,s).call(a,e,!0)),c}isGranted(t){return b(t),o(this,e)[t]===h.CONSENT_STATES.GRANTED}isDenied(t){return b(t),o(this,e)[t]===h.CONSENT_STATES.DENIED}state(){return Object.values(o(this,e)).every((e=>null!==e))?h.CONSENT_STATES.DETERMINATE:h.CONSENT_STATES.INDETERMINATE}setAll(e){E.isObject(e)?Object.entries(e).forEach((([e,s])=>l(this,t,n).call(this,e,s))):l(this,t,s).call(this,e)}resetConsent(){Object.keys(o(this,e)).forEach((t=>o(this,e)[t]=null))}toGTM(t=500){if(console.log(this),this.state()===h.CONSENT_STATES.INDETERMINATE){const t=Object.entries(o(this,e)).filter((e=>null===e[1]));throw new Error(`All tokens must have an explicit value. Undefined token${t.length>1?"s":""}: ${t.map((e=>e[0])).join(", ")}`)}const{analytics_consent:n,ad_consent:s}=o(this,e);return{ad_user_data:s,ad_personalization:s,ad_consent:s,analytics_consent:n,wait_for_update:t}}};exports.ConsentTokens=_;
//# sourceMappingURL=ConsentTokens.cjs.map
