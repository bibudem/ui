{"version":3,"file":"bib-consent-consent-dialog.js","sources":["../src/components/bib-consent/bib-consent-consent-dialog.js"],"sourcesContent":["import { css, html, LitElement, unsafeCSS } from 'lit'\nimport { createRef, ref } from 'lit/directives/ref.js'\nimport './bib-consent-dialog.js'\nimport { DEFAULT_PREFERENCES } from './constants.js'\nimport styles from './bib-consent-consent-dialog.scss?inline'\n\n/**\n * Creates an object with all properties of `DEFAULT_PREFERENCES` set to the provided `value`.\n *\n * @param {boolean} value - The value to set for all properties in the returned object.\n * @returns {Object} An object with all properties of `DEFAULT_PREFERENCES` set to the provided `value`.\n */\nfunction all(value) {\n  return Object.keys(DEFAULT_PREFERENCES).reduce((prefs, prop) => ({ ...prefs, [prop]: value }), {})\n}\n\n/**\n * The `BibConsentConsentDialog` component creates a consent dialog for managing user preferences related to cookies and other tracking technologies.\n *\n * The component provides the following functionality:\n * - Displays a consent dialog with options to customize preferences, accept all, or reject all.\n * - Allows setting preferences by dispatching a `update` event with the new preferences.\n * - Provides methods to show, close, and display the preferences dialog.\n *\n * The component uses the `bib-consent-dialog` component to render the actual dialog.\n */\nexport class BibConsentConsentDialog extends LitElement {\n  static properties = {\n    debug: {\n      type: Boolean,\n      reflect: true\n    },\n    open: {\n      type: Boolean,\n      state: true\n    },\n  }\n\n  static styles = [\n    css`${unsafeCSS(styles)}`\n  ]\n\n  constructor() {\n    super()\n    this.open = false\n    this.dialogRef = createRef()\n  }\n\n  /**\n   * Sets the preferences for the consent dialog.\n   *\n   * @param {Object} preferences - An object containing the preferences to set.\n   * @emits update - Dispatches a custom event with the updated preferences.\n   */\n  setConsentTokens(preferences) {\n    this.dispatchEvent(new CustomEvent('update', { detail: preferences }))\n  }\n\n  /**\n   * Shows the consent dialog if it is not already open.\n   */\n  show() {\n    if (this.dialogRef.value && !this.dialogRef.value.open) {\n      this.dialogRef.value?.show()\n    }\n  }\n\n  /**\n   * Closes the consent dialog if it is currently open.\n   */\n  close() {\n    if (this.dialogRef.value && this.dialogRef.value.open) {\n      this.dialogRef.value?.close()\n    }\n  }\n\n  /**\n   * Shows the preferences dialog for the consent dialog.\n   *\n   * This method dispatches a custom 'show-preferences' event to notify other components that the preferences dialog should be shown.\n   */\n  showPreferences() {\n    this.dispatchEvent(new CustomEvent('show-preferences'))\n  }\n\n  render() {\n    return html`\n      <bib-consent-dialog class=\"consent-dialog\" ${ref(this.dialogRef)}>\n        <div class=\"title\" autofocus>\n          L’UdeM reconnaît l’importance de respecter la vie privée\n        </div>\n        <p>\n          Vos données personnelles sont utilisées pour enregistrer vos préférences, votre consentement et produire des statistiques anonymes.<br> Pour plus d'informations, veuillez consulter notre \n          <a href=\"https://vie-privee.umontreal.ca/confidentialite\" target=\"_blank\" rel=\"noopener noreferrer\">politique de confidentialité</a> \n          et nos \n          <a href=\"https://vie-privee.umontreal.ca/conditions-dutilisation\" target=\"_blank\" rel=\"noopener noreferrer\">conditions d’utilisation</a>.\n        </p>\n        <div class=\"actions-container\">\n          <a href=\"#\" @click=\"${() => this.showPreferences()}\" class=\"consent-link\">Personnaliser les témoins</a>\n          <button class=\"btn--outlined\" type=\"button\" @click=\"${() => this.setConsentTokens(false)}\">Tout refuser</button>\n          <button class=\"btn--filled\" type=\"button\" @click=\"${() => this.setConsentTokens(true)}\">Tout accepter</button>\n        </div>\n      </bib-consent-dialog>\n    `\n  }\n}\n\nif (!window.customElements.get('bib-consent-consent-dialog')) {\n  window.customElements.define('bib-consent-consent-dialog', BibConsentConsentDialog)\n}"],"names":["BibConsentConsentDialog","LitElement","constructor","super","this","open","dialogRef","createRef","preferences","dispatchEvent","CustomEvent","detail","value","show","close","render","html","ref","showPreferences","setConsentTokens","static","debug","type","Boolean","reflect","state","css","unsafeCSS","window","customElements","get","define"],"mappings":";;;;;;AA0BO,MAAMA,UAAgCC,EAAAA;AAAAA,EAgB3C,cAAAC;AACEC,UACAC,GAAAA,KAAKC,OAAO,OACZD,KAAKE,YAAYC,EAClB;AAAA,EAAA;AAAA,EAQD,iBAAiBC;AACfJ,SAAKK,cAAc,IAAIC,YAAY,UAAU,EAAEC,QAAQH,GAAAA,CAAAA,CAAAA;AAAAA,EACxD;AAAA,EAKD,OACMJ;AAAAA,SAAKE,UAAUM,SAAAA,CAAUR,KAAKE,UAAUM,MAAMP,QAChDD,KAAKE,UAAUM,OAAOC,KAEzB;AAAA,EAAA;AAAA,EAKD,QAAAC;AACMV,SAAKE,UAAUM,SAASR,KAAKE,UAAUM,MAAMP,QAC/CD,KAAKE,UAAUM,OAAOE,MAAAA;AAAAA,EAEzB;AAAA,EAOD,kBACEV;AAAAA,SAAKK,cAAc,IAAIC,YAAY,kBAAA,CAAA;AAAA,EACpC;AAAA,EAED,SAAAK;AACE,WAAOC,+CACwCC,EAAIb,KAAKE,SAAAA,CAAAA,wmBAW5B,MAAMF,KAAKc,gBACqB,CAAA,4GAAA,MAAMd,KAAKe,iBAAAA,KACb,CAAA,6EAAA,MAAMf,KAAKe,iBAAAA,IAItE,CAAA;AAAA,EAAA;AAAA;AA7EDC,cADWpB,GACS,cAAA,EAClBqB,OAAO,EACLC,MAAMC,SACNC,SAAAA,KAEFnB,GAAAA,MAAM,EACJiB,MAAMC,SACNE,OAAAA,KAIJL,EAAAA;AAAAA,cAZWpB,GAYXoB,UAAgB,CACdM,IAAMC;AAoELC,OAAOC,eAAeC,IAAI,4BAAA,KAC7BF,OAAOC,eAAeE,OAAO,8BAA8B/B;"}