{"version":3,"file":"bib-consent.js","sources":["../node_modules/@lit/context/lib/value-notifier.js","../node_modules/@lit/context/lib/controllers/context-provider.js","isObject-Dipzh7kZ.js","_Uint8Array-Cf-PTZCw.js","../src/components/bib-consent/bib-consent.js"],"sourcesContent":["/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nclass s{get value(){return this.o}set value(s){this.setValue(s)}setValue(s,t=!1){const i=t||!Object.is(s,this.o);this.o=s,i&&this.updateObservers()}constructor(s){this.subscriptions=new Map,this.updateObservers=()=>{for(const[s,{disposer:t}]of this.subscriptions)s(this.o,t)},void 0!==s&&(this.value=s)}addCallback(s,t,i){if(!i)return void s(this.value);this.subscriptions.has(s)||this.subscriptions.set(s,{disposer:()=>{this.subscriptions.delete(s)},consumerHost:t});const{disposer:h}=this.subscriptions.get(s);s(this.value,h)}clearCallbacks(){this.subscriptions.clear()}}export{s as ValueNotifier};\n//# sourceMappingURL=value-notifier.js.map\n","import{ContextRequestEvent as t}from\"../context-request-event.js\";import{ValueNotifier as s}from\"../value-notifier.js\";\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class e extends Event{constructor(t){super(\"context-provider\",{bubbles:!0,composed:!0}),this.context=t}}class i extends s{constructor(s,e,i){super(void 0!==e.context?e.initialValue:i),this.onContextRequest=t=>{const s=t.composedPath()[0];t.context===this.context&&s!==this.host&&(t.stopPropagation(),this.addCallback(t.callback,s,t.subscribe))},this.onProviderRequest=s=>{const e=s.composedPath()[0];if(s.context!==this.context||e===this.host)return;const i=new Set;for(const[s,{consumerHost:e}]of this.subscriptions)i.has(s)||(i.add(s),e.dispatchEvent(new t(this.context,s,!0)));s.stopPropagation()},this.host=s,void 0!==e.context?this.context=e.context:this.context=e,this.attachListeners(),this.host.addController?.(this)}attachListeners(){this.host.addEventListener(\"context-request\",this.onContextRequest),this.host.addEventListener(\"context-provider\",this.onProviderRequest)}hostConnected(){this.host.dispatchEvent(new e(this.context))}}export{i as ContextProvider,e as ContextProviderEvent};\n//# sourceMappingURL=context-provider.js.map\n","/**\r\n * Librairie du system desing des Bibliothèques de l'Université de Montréal\r\n * @module @bibudem/ui\r\n * @version 1.1.1\r\n * @author Christian Rémillard <christian.remillard@umontreal.ca>\r\n * @license ISC\r\n * @see https://github.com/bibudem/ui\r\n */\r\nvar t = \"object\" == typeof global && global && global.Object === Object && global, e = \"object\" == typeof self && self && self.Object === Object && self, o = t || e || Function(\"return this\")(), n = o.Symbol, l = Object.prototype, r = l.hasOwnProperty, c = l.toString, a = n ? n.toStringTag : void 0, b = Object.prototype.toString, i = n ? n.toStringTag : void 0;\r\nfunction u(t2) {\r\n  return null == t2 ? void 0 === t2 ? \"[object Undefined]\" : \"[object Null]\" : i && i in Object(t2) ? function(t3) {\r\n    var e2 = r.call(t3, a), o2 = t3[a];\r\n    try {\r\n      t3[a] = void 0;\r\n      var n2 = true;\r\n    } catch (t4) {\r\n    }\r\n    var l2 = c.call(t3);\r\n    return n2 && (e2 ? t3[a] = o2 : delete t3[a]), l2;\r\n  }(t2) : function(t3) {\r\n    return b.call(t3);\r\n  }(t2);\r\n}\r\nfunction f(t2) {\r\n  return null != t2 && \"object\" == typeof t2;\r\n}\r\nfunction j(t2) {\r\n  var e2 = typeof t2;\r\n  return null != t2 && (\"object\" == e2 || \"function\" == e2);\r\n}\r\nexport {\r\n  n as S,\r\n  j as a,\r\n  u as b,\r\n  t as f,\r\n  f as i,\r\n  o as r\r\n};\r\n//# sourceMappingURL=isObject-Dipzh7kZ.js.map\r\n","/**\r\n * Librairie du system desing des Bibliothèques de l'Université de Montréal\r\n * @module @bibudem/ui\r\n * @version 1.1.1\r\n * @author Christian Rémillard <christian.remillard@umontreal.ca>\r\n * @license ISC\r\n * @see https://github.com/bibudem/ui\r\n */\r\nimport { a as t, b as e, r, i as o, f as n } from \"./isObject-Dipzh7kZ.js\";\r\nvar a = Array.isArray, i = \"[object AsyncFunction]\", s = \"[object Function]\", u = \"[object GeneratorFunction]\", c = \"[object Proxy]\";\r\nfunction p(r2) {\r\n  if (!t(r2)) return false;\r\n  var o2 = e(r2);\r\n  return o2 == s || o2 == u || o2 == i || o2 == c;\r\n}\r\nvar _, h = r[\"__core-js_shared__\"], f = (_ = /[^.]+$/.exec(h && h.keys && h.keys.IE_PROTO || \"\")) ? \"Symbol(src)_1.\" + _ : \"\", l = Function.prototype.toString;\r\nfunction y(t2) {\r\n  if (null != t2) {\r\n    try {\r\n      return l.call(t2);\r\n    } catch (t3) {\r\n    }\r\n    try {\r\n      return t2 + \"\";\r\n    } catch (t3) {\r\n    }\r\n  }\r\n  return \"\";\r\n}\r\nvar d = /^\\[object .+?Constructor\\]$/, b = Function.prototype, v = Object.prototype, j = b.toString, g = v.hasOwnProperty, m = RegExp(\"^\" + j.call(g).replace(/[\\\\^$.*+?()[\\]{}|]/g, \"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, \"$1.*?\") + \"$\");\r\nfunction z(e2, r2) {\r\n  var o2 = function(t2, e3) {\r\n    return null == t2 ? void 0 : t2[e3];\r\n  }(e2, r2);\r\n  return function(e3) {\r\n    return !(!t(e3) || (r3 = e3, f && f in r3)) && (p(e3) ? m : d).test(y(e3));\r\n    var r3;\r\n  }(o2) ? o2 : void 0;\r\n}\r\nvar A = 9007199254740991, O = /^(?:0|[1-9]\\d*)$/;\r\nfunction x(t2, e2) {\r\n  var r2 = typeof t2;\r\n  return !!(e2 = null == e2 ? A : e2) && (\"number\" == r2 || \"symbol\" != r2 && O.test(t2)) && t2 > -1 && t2 % 1 == 0 && t2 < e2;\r\n}\r\nfunction w(t2, e2) {\r\n  return t2 === e2 || t2 != t2 && e2 != e2;\r\n}\r\nvar F = 9007199254740991;\r\nfunction P(t2) {\r\n  return \"number\" == typeof t2 && t2 > -1 && t2 % 1 == 0 && t2 <= F;\r\n}\r\nfunction S(t2) {\r\n  return null != t2 && P(t2.length) && !p(t2);\r\n}\r\nvar $ = Object.prototype;\r\nfunction T(t2) {\r\n  var e2 = t2 && t2.constructor;\r\n  return t2 === (\"function\" == typeof e2 && e2.prototype || $);\r\n}\r\nfunction U(t2) {\r\n  return o(t2) && \"[object Arguments]\" == e(t2);\r\n}\r\nvar E = Object.prototype, I = E.hasOwnProperty, k = E.propertyIsEnumerable, B = U(/* @__PURE__ */ function() {\r\n  return arguments;\r\n}()) ? U : function(t2) {\r\n  return o(t2) && I.call(t2, \"callee\") && !k.call(t2, \"callee\");\r\n}, M = \"object\" == typeof exports && exports && !exports.nodeType && exports, R = M && \"object\" == typeof module && module && !module.nodeType && module, q = R && R.exports === M ? r.Buffer : void 0, C = (q ? q.isBuffer : void 0) || function() {\r\n  return false;\r\n}, D = {};\r\nD[\"[object Float32Array]\"] = D[\"[object Float64Array]\"] = D[\"[object Int8Array]\"] = D[\"[object Int16Array]\"] = D[\"[object Int32Array]\"] = D[\"[object Uint8Array]\"] = D[\"[object Uint8ClampedArray]\"] = D[\"[object Uint16Array]\"] = D[\"[object Uint32Array]\"] = true, D[\"[object Arguments]\"] = D[\"[object Array]\"] = D[\"[object ArrayBuffer]\"] = D[\"[object Boolean]\"] = D[\"[object DataView]\"] = D[\"[object Date]\"] = D[\"[object Error]\"] = D[\"[object Function]\"] = D[\"[object Map]\"] = D[\"[object Number]\"] = D[\"[object Object]\"] = D[\"[object RegExp]\"] = D[\"[object Set]\"] = D[\"[object String]\"] = D[\"[object WeakMap]\"] = false;\r\nvar G, L = \"object\" == typeof exports && exports && !exports.nodeType && exports, N = L && \"object\" == typeof module && module && !module.nodeType && module, V = N && N.exports === L && n.process, W = function() {\r\n  try {\r\n    return N && N.require && N.require(\"util\").types || V && V.binding && V.binding(\"util\");\r\n  } catch (t2) {\r\n  }\r\n}(), H = W && W.isTypedArray, J = H ? (G = H, function(t2) {\r\n  return G(t2);\r\n}) : function(t2) {\r\n  return o(t2) && P(t2.length) && !!D[e(t2)];\r\n}, K = Object.prototype.hasOwnProperty;\r\nfunction Q(t2, e2) {\r\n  var r2 = a(t2), o2 = !r2 && B(t2), n2 = !r2 && !o2 && C(t2), i2 = !r2 && !o2 && !n2 && J(t2), s2 = r2 || o2 || n2 || i2, u2 = s2 ? function(t3, e3) {\r\n    for (var r3 = -1, o3 = Array(t3); ++r3 < t3; ) o3[r3] = e3(r3);\r\n    return o3;\r\n  }(t2.length, String) : [], c2 = u2.length;\r\n  for (var p2 in t2) !e2 && !K.call(t2, p2) || s2 && (\"length\" == p2 || n2 && (\"offset\" == p2 || \"parent\" == p2) || i2 && (\"buffer\" == p2 || \"byteLength\" == p2 || \"byteOffset\" == p2) || x(p2, c2)) || u2.push(p2);\r\n  return u2;\r\n}\r\nfunction X(t2, e2) {\r\n  return function(r2) {\r\n    return t2(e2(r2));\r\n  };\r\n}\r\nvar Y = z(Object, \"create\"), Z = Object.prototype.hasOwnProperty, tt = Object.prototype.hasOwnProperty;\r\nfunction et(t2) {\r\n  var e2 = -1, r2 = null == t2 ? 0 : t2.length;\r\n  for (this.clear(); ++e2 < r2; ) {\r\n    var o2 = t2[e2];\r\n    this.set(o2[0], o2[1]);\r\n  }\r\n}\r\nfunction rt(t2, e2) {\r\n  for (var r2 = t2.length; r2--; ) if (w(t2[r2][0], e2)) return r2;\r\n  return -1;\r\n}\r\net.prototype.clear = function() {\r\n  this.__data__ = Y ? Y(null) : {}, this.size = 0;\r\n}, et.prototype.delete = function(t2) {\r\n  var e2 = this.has(t2) && delete this.__data__[t2];\r\n  return this.size -= e2 ? 1 : 0, e2;\r\n}, et.prototype.get = function(t2) {\r\n  var e2 = this.__data__;\r\n  if (Y) {\r\n    var r2 = e2[t2];\r\n    return \"__lodash_hash_undefined__\" === r2 ? void 0 : r2;\r\n  }\r\n  return Z.call(e2, t2) ? e2[t2] : void 0;\r\n}, et.prototype.has = function(t2) {\r\n  var e2 = this.__data__;\r\n  return Y ? void 0 !== e2[t2] : tt.call(e2, t2);\r\n}, et.prototype.set = function(t2, e2) {\r\n  var r2 = this.__data__;\r\n  return this.size += this.has(t2) ? 0 : 1, r2[t2] = Y && void 0 === e2 ? \"__lodash_hash_undefined__\" : e2, this;\r\n};\r\nvar ot = Array.prototype.splice;\r\nfunction nt(t2) {\r\n  var e2 = -1, r2 = null == t2 ? 0 : t2.length;\r\n  for (this.clear(); ++e2 < r2; ) {\r\n    var o2 = t2[e2];\r\n    this.set(o2[0], o2[1]);\r\n  }\r\n}\r\nnt.prototype.clear = function() {\r\n  this.__data__ = [], this.size = 0;\r\n}, nt.prototype.delete = function(t2) {\r\n  var e2 = this.__data__, r2 = rt(e2, t2);\r\n  return !(r2 < 0 || (r2 == e2.length - 1 ? e2.pop() : ot.call(e2, r2, 1), --this.size, 0));\r\n}, nt.prototype.get = function(t2) {\r\n  var e2 = this.__data__, r2 = rt(e2, t2);\r\n  return r2 < 0 ? void 0 : e2[r2][1];\r\n}, nt.prototype.has = function(t2) {\r\n  return rt(this.__data__, t2) > -1;\r\n}, nt.prototype.set = function(t2, e2) {\r\n  var r2 = this.__data__, o2 = rt(r2, t2);\r\n  return o2 < 0 ? (++this.size, r2.push([t2, e2])) : r2[o2][1] = e2, this;\r\n};\r\nvar at = z(r, \"Map\");\r\nfunction it(t2, e2) {\r\n  var r2, o2, n2 = t2.__data__;\r\n  return (\"string\" == (o2 = typeof (r2 = e2)) || \"number\" == o2 || \"symbol\" == o2 || \"boolean\" == o2 ? \"__proto__\" !== r2 : null === r2) ? n2[\"string\" == typeof e2 ? \"string\" : \"hash\"] : n2.map;\r\n}\r\nfunction st(t2) {\r\n  var e2 = -1, r2 = null == t2 ? 0 : t2.length;\r\n  for (this.clear(); ++e2 < r2; ) {\r\n    var o2 = t2[e2];\r\n    this.set(o2[0], o2[1]);\r\n  }\r\n}\r\nfunction ut(t2) {\r\n  var e2 = this.__data__ = new nt(t2);\r\n  this.size = e2.size;\r\n}\r\nst.prototype.clear = function() {\r\n  this.size = 0, this.__data__ = { hash: new et(), map: new (at || nt)(), string: new et() };\r\n}, st.prototype.delete = function(t2) {\r\n  var e2 = it(this, t2).delete(t2);\r\n  return this.size -= e2 ? 1 : 0, e2;\r\n}, st.prototype.get = function(t2) {\r\n  return it(this, t2).get(t2);\r\n}, st.prototype.has = function(t2) {\r\n  return it(this, t2).has(t2);\r\n}, st.prototype.set = function(t2, e2) {\r\n  var r2 = it(this, t2), o2 = r2.size;\r\n  return r2.set(t2, e2), this.size += r2.size == o2 ? 0 : 1, this;\r\n}, ut.prototype.clear = function() {\r\n  this.__data__ = new nt(), this.size = 0;\r\n}, ut.prototype.delete = function(t2) {\r\n  var e2 = this.__data__, r2 = e2.delete(t2);\r\n  return this.size = e2.size, r2;\r\n}, ut.prototype.get = function(t2) {\r\n  return this.__data__.get(t2);\r\n}, ut.prototype.has = function(t2) {\r\n  return this.__data__.has(t2);\r\n}, ut.prototype.set = function(t2, e2) {\r\n  var r2 = this.__data__;\r\n  if (r2 instanceof nt) {\r\n    var o2 = r2.__data__;\r\n    if (!at || o2.length < 199) return o2.push([t2, e2]), this.size = ++r2.size, this;\r\n    r2 = this.__data__ = new st(o2);\r\n  }\r\n  return r2.set(t2, e2), this.size = r2.size, this;\r\n};\r\nvar ct = r.Uint8Array;\r\nexport {\r\n  at as M,\r\n  ut as S,\r\n  ct as U,\r\n  S as a,\r\n  Q as b,\r\n  a as c,\r\n  st as d,\r\n  w as e,\r\n  C as f,\r\n  z as g,\r\n  J as h,\r\n  T as i,\r\n  x as j,\r\n  B as k,\r\n  p as l,\r\n  X as o,\r\n  y as t\r\n};\r\n//# sourceMappingURL=_Uint8Array-Cf-PTZCw.js.map\r\n","import { html, LitElement } from 'lit'\r\nimport { createRef, ref } from 'lit/directives/ref.js'\r\nimport { ContextProvider, ContextConsumer } from '@lit/context'\r\nimport '@auroratide/toggle-switch/lib/define.js'\r\nimport { loggerFactory } from '@/utils/logger.js'\r\nimport { addToGlobalBib } from '@/utils/bib.js'\r\nimport { dispatchPublicEvent } from '@/utils/events.js'\r\nimport { ConsentTokens } from './ConsentTokens.js'\r\nimport createConsentClient from './consentClient.js'\r\nimport { consentContext } from './consent-context.js'\r\nimport '../bib-button/bib-button-close.js'\r\nimport './bib-consent-consent-dialog.js'\r\nimport './bib-consent-preferences-dialog.js'\r\nimport { CONSENT_STATES, EVENT_NAMES, SERVER_MODE, SERVER_REQUEST_DEFAULT_TIMEOUT, SERVER_DEFAULT_URL } from './constants.js'\r\nimport { c } from '../../../dist/_Uint8Array-Cf-PTZCw.js'\r\n\r\nconst debug = loggerFactory('bib-consent', '#cd5300')\r\n\r\n/**\r\n * @typedef {'indeterminate' | 'determinate'} ConsentState\r\n */\r\n\r\n/**\r\n * The `BibConsent` class is a custom web component that provides a user interface for managing consent preferences.\r\n *\r\n * It includes the following functionality:\r\n * - Fetching and displaying the user's consent preferences from a server\r\n * - Allowing the user to change their consent preferences\r\n * - Saving the changed consent preferences to the server\r\n * - Providing a consent dialog and a preferences dialog for the user to interact with\r\n *\r\n * The component can be configured with the following properties:\r\n * - `serverUrl`: the URL of the server where the consent preferences are stored\r\n * - `serverRequestTimeout`: the timeout for requests to the server\r\n * - `[SERVER_MODE.LOCAL]`: a boolean indicating whether the component is running in local mode\r\n * - `debug`: a boolean indicating whether debug logging should be enabled\r\n * - `open`: a boolean indicating whether the consent dialog or preferences dialog is currently open\r\n *\r\n * The component uses the `@lit/context` library to manage the consent preferences as a shared context, and the `createConsentClient` function to interact with the server.\r\n * \r\n * @class BibConsent\r\n * @extends LitElement\r\n * @property {string} serverUrl - The URL of the server where the consent preferences are stored.\r\n * @property {number} serverRequestTimeout - The timeout for requests to the server.\r\n * @property {boolean} [SERVER_MODE.LOCAL] - A boolean indicating whether the component is running in local mode.\r\n * @property {boolean} debug - A boolean indicating whether debug logging should be enabled.\r\n * @property {boolean} open - A boolean indicating whether the consent dialog or preferences dialog is currently open.\r\n * @property {ConsentState} state - The current state of the BibConsent component, which can be one of the following values:\r\n *   - `indeterminate`: The user has not yet indicated their consent preferences.\r\n *   - `determinate`: The user has made their consent preferences.\r\n * @property {import('./ConsentTokens.js').ConsentTokens} consentTokens - The user's consent tokens.\r\n * @emits {CustomEvent} EVENT_NAMES.READY - Emitted when the consent client is ready.\r\n * @emits {CustomEvent} EVENT_NAMES.CHANGE - Emitted when the consent preferences are changed.\r\n * @emits {CustomEvent} context-request - Emitted when the context is requested.\r\n * @method connectedCallback - Initializes the component and sets up the necessary state and references.\r\n * @method close - Closes the current dialog and sets the `open` property to `false`.\r\n * @method show - Shows the consent dialog.\r\n * @method showPreferences - Shows the preferences dialog.\r\n * @method getTokens - Gets the user's consent tokens.\r\n * @method saveTokens - Saves the user's consent tokens to the server.\r\n * @method resetTokens - Resets the user's consent tokens to their default values.\r\n * @method render - Renders the component.\r\n */\r\nexport class BibConsent extends LitElement {\r\n  static properties = {\r\n    serverUrl: {\r\n      type: String,\r\n      attribute: 'server-url'\r\n    },\r\n    serverRequestTimeout: {\r\n      type: Number,\r\n      attribute: 'server-request-timeout'\r\n    },\r\n    [SERVER_MODE.LOCAL]: {\r\n      type: Boolean\r\n    },\r\n    state: {\r\n      type: String\r\n    },\r\n    debug: {\r\n      type: Boolean,\r\n      reflect: true\r\n    },\r\n    open: {\r\n      type: Boolean,\r\n      reflect: true\r\n    },\r\n  }\r\n\r\n  _consentClient\r\n  #consentTokens\r\n  #consentProvider\r\n  #consentConsumer\r\n  #state = CONSENT_STATES.INDETERMINATE\r\n  #consentDialogRef\r\n  #preferencesDialogRef\r\n\r\n  /**\r\n   * Initializes the `BibConsent` component, setting up the necessary state and references.\r\n   * \r\n   * The constructor performs the following tasks:\r\n   * - Calls the parent class constructor (`super()`)\r\n   * - Initializes the `open` property to `false`, indicating that no dialog is currently open\r\n   * - Sets the `currentDialog` property to `null`, as no dialog is currently open\r\n   * - Creates references to the consent dialog and preferences dialog using `createRef()`\r\n   * - Creates a `ContextProvider` instance for the consent context, with the component instance as the host and an initial value of `null`\r\n   * - Creates a `ContextConsumer` instance for the consent context, with the component instance as the host and the `savePreferences` method as the callback\r\n   */\r\n  constructor() {\r\n    super()\r\n    this.open = false\r\n    this.currentDialog = null\r\n    this.#consentDialogRef = createRef()\r\n    this.#preferencesDialogRef = createRef()\r\n    this.#consentProvider = new ContextProvider(this, { context: consentContext, initialValue: new ConsentTokens() })\r\n    this.#consentConsumer = new ContextConsumer(this, { context: consentContext, callback: this.savePreferences })\r\n  }\r\n\r\n  #dispatchPublicEvent(name, detail = null) {\r\n    dispatchPublicEvent(this, name, { detail })\r\n  }\r\n\r\n  /**\r\n   * Gets the current state of the BibConsent component.\r\n   * The state is determined by the user's input. Initially `indeterminate`, it turns `determinate` when the user has indicated their consent preferences.\r\n   * @readonly\r\n   * @returns {import('./constants.js').consentStateTypes} The current state of the BibConsent component, which can be one of the following values:\r\n   * - `indeterminate`: The user has not yet indicated their consent preferences.\r\n   * - `determinate`: The user has made their consent preferences.\r\n   */\r\n  get state() {\r\n    return this.#state\r\n  }\r\n\r\n  // /**\r\n  //  * Gets the user's consent tokens.\r\n  //  * @readonly\r\n  //  * @returns {import('./ConsentTokens.js').ConsentTokens} The user's consent tokens.\r\n  //  */\r\n  // get consentTokens() {\r\n  //   return this.#consentConsumer.value\r\n  // }\r\n\r\n  /**\r\n   * Initializes the `BibConsent` component, sets up the necessary state and references, and handles events related to the consent client.\r\n   * \r\n   * The `connectedCallback` method performs the following tasks:\r\n   * - Calls the parent class's `connectedCallback` method\r\n   * - Sets the `debug` property to `false` if it is not already defined\r\n   * - Sets the `serverUrl` property to `'https://bib.umontreal.ca/consent/server/'` if it is not already defined\r\n   * - Sets the `serverRequestTimeout` property to `SERVER_REQUEST_DEFAULT_TIMEOUT` if it is not already defined\r\n   * - Creates a `ConsentClient` instance and assigns it to the `_consentClient` property\r\n   * - Adds event listeners for the `EVENT_NAMES.READY` and `EVENT_NAMES.CHANGE` events on the `_consentClient` instance\r\n   * - Adds an event listener for the `context-request` event on the component's shadow root, which responds with the current tokens\r\n   */\r\n  async connectedCallback() {\r\n    super.connectedCallback()\r\n    this.debug = this.debug || false\r\n    this.serverUrl = this.serverUrl || SERVER_DEFAULT_URL\r\n    this.serverRequestTimeout = this.serverRequestTimeout || SERVER_REQUEST_DEFAULT_TIMEOUT\r\n\r\n    this._consentClient = await createConsentClient({ host: this, serverUrl: this.serverUrl, serverRequestTimeout: this.serverRequestTimeout, reflectEvents: true })\r\n\r\n    this._consentClient.addEventListener(EVENT_NAMES.READY, event => {\r\n\r\n      const { detail: consentData } = event\r\n\r\n      if (consentData.getState() === CONSENT_STATES.DETERMINATE) {\r\n        this.#setValue(consentData)\r\n      } else {\r\n        this.#show('consent')\r\n      }\r\n\r\n      this.#dispatchPublicEvent(EVENT_NAMES.READY, { ...consentData.toObject(), a: 'allo' })\r\n    })\r\n  }\r\n\r\n  #setValue(value) {\r\n    this.#consentProvider.setValue(value)\r\n    this.#state = this.#consentProvider.value.getState()\r\n  }\r\n\r\n  #debug() {\r\n    if (this.debug) {\r\n      debug(...arguments)\r\n    }\r\n  }\r\n\r\n  #close(emit = true) {\r\n    this.open = false\r\n    this.currentDialog?.close(emit)\r\n    this.currentDialog = null\r\n\r\n    if (emit) {\r\n      this.#dispatchPublicEvent(EVENT_NAMES.CLOSE)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Closes the current dialog, if any, and sets the `open` property to `false`.\r\n   */\r\n  close() {\r\n    this.#close()\r\n  }\r\n\r\n  #show(panel = 'consent') {\r\n\r\n    const validPanels = ['consent', 'preferences']\r\n\r\n    if (typeof panel !== 'string' && !validPanels.includes(panel)) {\r\n      throw new TypeError(`The panel argument must be a string of either values \\`${validPanels.join(` or `)}\\`. You provided \\`${panel}\\``, panel)\r\n    }\r\n\r\n    this.open = true\r\n\r\n    if (this.currentDialog) {\r\n      this.#debug('[#show] this.currentDialog', this.currentDialog)\r\n      this.currentDialog.close()\r\n    }\r\n\r\n    this.#debug('[show]', this.#consentDialogRef.value)\r\n    this.#debug('[show]', this.#preferencesDialogRef.value)\r\n    this.currentDialog = panel === 'consent' ? this.#consentDialogRef.value : this.#preferencesDialogRef.value\r\n    this.currentDialog.show()\r\n  }\r\n\r\n  /**\r\n   * Shows the consent dialog.\r\n   */\r\n  show() {\r\n    this.#show('consent')\r\n  }\r\n\r\n  /**\r\n   * Shows the preferences dialog.\r\n   */\r\n  showPreferences() {\r\n    this.#show('preferences')\r\n  }\r\n\r\n  /**\r\n   * Retrieves the user's consent tokens from the server.\r\n   *\r\n   * @returns {Promise<Object>} - A promise that resolves to the user's consent tokens.\r\n   */\r\n  async getTokens() {\r\n    this.#consentTokens = await this._consentClient.getConsentTokens()\r\n    return this.#consentTokens.toObject()\r\n  }\r\n\r\n  /**\r\n   * Saves the user's consent tokens to the server.\r\n   *\r\n   * @param {Object} preferences - The user's consent preferences.\r\n   * @returns {Promise<boolean>} - A promise that resolves to `true` if the preferences were saved successfully, or `false` if there was an error.\r\n   */\r\n\r\n  async saveTokens(tokens) {\r\n    this.#debug('[save] tokens: ', tokens)\r\n    const consentTokens = ConsentTokens.from(tokens)\r\n    try {\r\n      await this._consentClient.setConsentTokens(consentTokens)\r\n      this.#setValue(consentTokens)\r\n      return true\r\n    } catch (error) {\r\n      console.error('[savePreferences] error: ', error)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Resets the user's consent preferences to their default values.\r\n   *\r\n   * @returns {Promise<Object>} - A promise that resolves to the user's reset consent preferences.\r\n   */\r\n  async resetTokens() {\r\n    await this._consentClient.resetTokens()\r\n    const tokens = await this._consentClient.getConsentTokens()\r\n    this.#consentTokens = tokens\r\n    this.#dispatchPublicEvent(EVENT_NAMES.CHANGE, tokens.toObject())\r\n    return tokens\r\n  }\r\n\r\n  async #handleChangeEvent(event) {\r\n    // this.#debug('[#handleChangeEvent]', event)\r\n    const success = await this.saveTokens(event.detail)\r\n    // this.#debug('[#handleChangeEvent] success: ', success)\r\n\r\n    if (!success) {\r\n      // TODO: show error message\r\n      return\r\n    }\r\n\r\n    const tokens = await this.getTokens()\r\n    this.#dispatchPublicEvent(EVENT_NAMES.CHANGE, tokens)\r\n    this.#close()\r\n  }\r\n\r\n  #handleCloseEvent(event) {\r\n    this.#close(false)\r\n  }\r\n\r\n  render() {\r\n    return html`\r\n        <bib-consent-consent-dialog @intern:change=\"${this.#handleChangeEvent}\" @intern:show-preferences=\"${() => this.#show('preferences')}\" ${ref(this.#consentDialogRef)} @intern:close=\"${this.#handleCloseEvent}\"></bib-consent-consent-dialog>\r\n        <bib-consent-preferences-dialog @intern:change=\"${this.#handleChangeEvent}\" ${ref(this.#preferencesDialogRef)} @intern:close=\"${this.#handleCloseEvent}\"></bib-consent-preferences-dialog>\r\n    `\r\n  }\r\n}\r\n\r\nif (!window.customElements.get('bib-consent')) {\r\n  window.customElements.define('bib-consent', BibConsent)\r\n}\r\n\r\naddToGlobalBib('consent', {})"],"names":["value","this","o","s","setValue","t","i","Object","is","updateObservers","subscriptions","Map","disposer","has","set","delete","consumerHost","h","get","clearCallbacks","clear","e$1","Event","super","bubbles","composed","context","e","initialValue","onContextRequest","composedPath","host","stopPropagation","addCallback","callback","subscribe","onProviderRequest","Set","add","dispatchEvent","attachListeners","addController","addEventListener","global","self","Function","n","Symbol","l","prototype","r","hasOwnProperty","c","toString","a","toStringTag","b","u","t2","t3","e2","call","o2","n2","t4","l2","j","_","f","exec","keys","IE_PROTO","d","v","g","m","RegExp","replace","z","r2","e3","r3","test","E","propertyIsEnumerable","arguments","M","exports","nodeType","R","module","q","Buffer","isBuffer","L","N","V","process","W","require","types","binding","isTypedArray","Uint8Array","debug","loggerFactory","BibConsent","LitElement","static","_consentClient","consentTokens","consentProvider","consentConsumer","state","CONSENT_STATES","INDETERMINATE","consentDialogRef","preferencesDialogRef","open","currentDialog","createRef","ContextProvider","consentContext","ConsentTokens","ContextConsumer","savePreferences","connectedCallback","serverUrl","SERVER_DEFAULT_URL","serverRequestTimeout","SERVER_REQUEST_DEFAULT_TIMEOUT","createConsentClient","reflectEvents","EVENT_NAMES","READY","event","detail","consentData","getState","DETERMINATE","show","dispatchPublicEvent","toObject","showPreferences","getConsentTokens","saveTokens","tokens","from","setConsentTokens","error","console","resetTokens","CHANGE","html","ref","name","close","emit","CLOSE","panel","validPanels","includes","TypeError","join","handleChangeEvent","getTokens","handleCloseEvent","type","String","attribute","Number","SERVER_MODE","LOCAL","Boolean","reflect","window","customElements","define","addToGlobalBib"],"mappings":"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","x_google_ignoreList":[0,1]}