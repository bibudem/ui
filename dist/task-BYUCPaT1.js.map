{"version":3,"file":"task-BYUCPaT1.js","sources":["../node_modules/@lit/task/task.js"],"sourcesContent":["import{notEqual as t}from\"@lit/reactive-element\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s={INITIAL:0,PENDING:1,COMPLETE:2,ERROR:3},i=Symbol();class h{get taskComplete(){return this.t||(1===this.status?this.t=new Promise(((t,s)=>{this.i=t,this.o=s})):3===this.status?this.t=Promise.reject(this.h):this.t=Promise.resolve(this.l)),this.t}constructor(t,s,i){this.u=0,this.status=0,(this.p=t).addController(this);const h=\"object\"==typeof s?s:{task:s,args:i};this._=h.task,this.v=h.args,this.j=h.argsEqual??r,this.m=h.onComplete,this.g=h.onError,this.autoRun=h.autoRun??!0,\"initialValue\"in h&&(this.l=h.initialValue,this.status=2,this.k=this.A?.())}hostUpdate(){!0===this.autoRun&&this.O()}hostUpdated(){\"afterUpdate\"===this.autoRun&&this.O()}A(){if(void 0===this.v)return;const t=this.v();if(!Array.isArray(t))throw Error(\"The args function must return an array\");return t}async O(){const t=this.A(),s=this.k;this.k=t,t===s||void 0===t||void 0!==s&&this.j(s,t)||await this.run(t)}async run(t){let s,h;t??=this.A(),this.k=t,1===this.status?this.T?.abort():(this.t=void 0,this.i=void 0,this.o=void 0),this.status=1,\"afterUpdate\"===this.autoRun?queueMicrotask((()=>this.p.requestUpdate())):this.p.requestUpdate();const r=++this.u;this.T=new AbortController;let e=!1;try{s=await this._(t,{signal:this.T.signal})}catch(t){e=!0,h=t}if(this.u===r){if(s===i)this.status=0;else{if(!1===e){try{this.m?.(s)}catch{}this.status=2,this.i?.(s)}else{try{this.g?.(h)}catch{}this.status=3,this.o?.(h)}this.l=s,this.h=h}this.p.requestUpdate()}}abort(t){1===this.status&&this.T?.abort(t)}get value(){return this.l}get error(){return this.h}render(t){switch(this.status){case 0:return t.initial?.();case 1:return t.pending?.();case 2:return t.complete?.(this.value);case 3:return t.error?.(this.error);default:throw Error(\"Unexpected status: \"+this.status)}}}const r=(s,i)=>s===i||s.length===i.length&&s.every(((s,h)=>!t(s,i[h])));export{h as Task,s as TaskStatus,i as initialState,r as shallowArrayEquals};\n//# sourceMappingURL=task.js.map\n"],"names":["i","Symbol","h","taskComplete","this","t","status","Promise","s","o","reject","resolve","l","u","p","addController","task","args","_","v","j","argsEqual","r","m","onComplete","g","onError","autoRun","initialValue","k","A","O","hostUpdated","Array","isArray","Error","run","T","abort","queueMicrotask","requestUpdate","AbortController","e","signal","initial","pending","complete","value","error","length","every"],"mappings":";;;;;;AAKQ,MAA4CA,IAAEC,OAAS;AAAA,MAAMC;EAAE,IAAIC,eAAAA;AAAe,WAAOC,KAAKC,MAAI,MAAID,KAAKE,SAAOF,KAAKC,IAAE,IAAIE,QAAS,CAACF,IAAEG;AAAKJ,WAAKJ,IAAEK,IAAED,KAAKK,IAAED;AAAAA,IAAE,CAAG,IAAA,MAAIJ,KAAKE,SAAOF,KAAKC,IAAEE,QAAQG,OAAON,KAAKF,CAAGE,IAAAA,KAAKC,IAAEE,QAAQI,QAAQP,KAAKQ,CAAIR,IAAAA,KAAKC;AAAAA,EAAC;AAAA,EAAC,YAAYA,IAAEG,IAAER;AAAGI,SAAKS,IAAE,GAAET,KAAKE,SAAO,IAAGF,KAAKU,IAAET,IAAGU,cAAcX,IAAAA;AAAM,UAAMF,IAAE,YAAA,OAAiBM,KAAEA,KAAE,EAACQ,MAAKR,IAAES,MAAKjB;AAAGI,SAAKc,IAAEhB,EAAEc,MAAKZ,KAAKe,IAAEjB,EAAEe,MAAKb,KAAKgB,IAAElB,EAAEmB,aAAWC,GAAElB,KAAKmB,IAAErB,EAAEsB,YAAWpB,KAAKqB,IAAEvB,EAAEwB,SAAQtB,KAAKuB,UAAQzB,EAAEyB,WAAS,MAAG,kBAAiBzB,MAAIE,KAAKQ,IAAEV,EAAE0B,cAAaxB,KAAKE,SAAO,GAAEF,KAAKyB,IAAEzB,KAAK0B;EAAM;AAAA,EAAC;aAAkB1B,KAAKuB,WAASvB,KAAK2B,EAAAA;AAAAA,EAAG;AAAA,EAAC,cAAAC;AAAc,sBAAgB5B,KAAKuB,WAASvB,KAAK2B,EAAG;AAAA,EAAA;AAAA,EAAC,IAAI;AAAA,QAAA,WAAY3B,KAAKe,EAAE;AAAO,UAAMd,KAAED,KAAKe,EAAI;AAAA,QAAA,CAAIc,MAAMC,QAAQ7B,EAAAA,EAAG,OAAM8B,MAAM,wCAAA;AAA0C,WAAO9B;AAAAA,EAAC;AAAA,EAAC,UAAU;AAAA,UAAMA,KAAED,KAAK0B,EAAAA,GAAItB,KAAEJ,KAAKyB;AAAEzB,SAAKyB,IAAExB,IAAEA,OAAIG,MAAG,WAASH,iBAAYG,MAAGJ,KAAKgB,EAAEZ,IAAEH,aAAUD,KAAKgC,IAAI/B;EAAE;AAAA,EAAC,MAAA,IAAUA,IAAG;AAAA,QAAIG,IAAEN;AAAEG,IAAAA,OAAID,KAAK0B,EAAI1B,GAAAA,KAAKyB,IAAExB,IAAE,MAAID,KAAKE,SAAOF,KAAKiC,GAAGC,MAASlC,KAAAA,KAAKC,YAASD,KAAKJ,YAASI,KAAKK,aAAUL,KAAKE,SAAO,GAAE,kBAAgBF,KAAKuB,UAAQY,qBAAoBnC,KAAKU,EAAE0B,mBAAkBpC,KAAKU,EAAE0B;AAAgB,UAAMlB,IAAAA,EAAIlB,KAAKS;AAAET,SAAKiC,IAAE,IAAII;AAAgB,QAAIC,IAAE;AAAG;AAAIlC,MAAAA,KAAQJ,MAAAA,KAAKc,EAAEb,IAAE,EAACsC,QAAOvC,KAAKiC,EAAEM;IAAQ,SAAOtC;AAAGqC,UAAE,MAAGxC,KAAEG;AAAAA,IAAC;AAAC,QAAGD,KAAKS,MAAIS,GAAE;AAAC,UAAGd,OAAIR,EAAEI,MAAKE,SAAO;AAAA,WAAM;AAAC,sBAAQoC,GAAE;AAAC,cAAItC;AAAAA,iBAAKmB,IAAIf,EAAE;AAAA,UAAA;UAAM;AAAEJ,eAAKE,SAAO,GAAEF,KAAKJ,IAAIQ,EAAE;AAAA,QAAA,OAAK;AAAC,cAAIJ;AAAAA,iBAAKqB,IAAIvB,EAAE;AAAA,UAAA;UAAM;AAAEE,eAAKE,SAAO,GAAEF,KAAKK,IAAIP,EAAE;AAAA,QAAA;AAACE,aAAKQ,IAAEJ,IAAEJ,KAAKF,IAAEA;AAAAA,MAAC;AAACE,WAAKU,EAAE0B;IAAe;AAAA,EAAC;AAAA,EAAC,MAAMnC,IAAAA;AAAG,UAAID,KAAKE,UAAQF,KAAKiC,GAAGC,MAAMjC;EAAE;AAAA,EAAC,IAAA;AAAY,WAAOD,KAAKQ;AAAAA,EAAC;AAAA,EAAC,IAAA;AAAY,WAAOR,KAAKF;AAAAA,EAAC;AAAA,EAAC,OAAOG,IAAG;AAAA,YAAOD,KAAKE,QAAQ;AAAA,MAAA,KAAK;AAAE,eAAOD,GAAEuC;MAAY,KAAK;AAAE,eAAOvC,GAAEwC,UAAAA;AAAAA,MAAY,KAAK;AAAE,eAAOxC,GAAEyC,WAAW1C,KAAK2C;MAAO,KAAK;AAAE,eAAO1C,GAAE2C,QAAQ5C,KAAK4C,KAAO;AAAA,MAAA;AAAQ,cAAMb,MAAM,wBAAsB/B,KAAKE,MAAQ;AAAA,IAAA;AAAA,EAAA;AAAA;AAAE,MAAMgB,IAAE,CAACd,IAAER,OAAIQ,OAAIR,MAAGQ,GAAEyC,WAASjD,GAAEiD,UAAQzC,GAAE0C,OAAQ1C,IAAEN,QAAKG,EAAEG,IAAER,GAAEE;","x_google_ignoreList":[0]}